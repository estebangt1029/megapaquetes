<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Metadatos del documento -->
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>¡BIENVENIDO ADMINISTRADOR!</title>
    <!-- Enlace al archivo CSS para estilos -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />

    <link rel="stylesheet" href="perfil_administrador.css" />
    <!-- Favicon para el navegador -->
    <link rel="icon" type="image/svg" href="../imagenes/logo.svg" />
  </head>
  <body>
    <!-- Barra de navegación -->
    <nav class="negrita navbar navbar-expand-lg p-4">
      <div class="container-fluid">
        <!-- Logo -->
        <img src="../imagenes/logo.svg" alt="logo" />
        <div class="px-4">
          <a class="nav-link active" href="">MEGAPAQUETES</a>
          <div class="esconder">
            <!-- Contenido escondido -->
          </div>
        </div>
        <!-- Botón para mostrar el menú en pantallas pequeñas -->
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarSupportedContent"
          aria-controls="navbarSupportedContent"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <!-- Contenedor del menú desplegable -->
        <div
          class="collapse navbar-collapse justify-content-center"
          id="navbarSupportedContent"
        >
          <ul class="navbar-nav d-flex gap-5">
            <!-- Elementos del menú -->
            <li class="nav-item">
              <a
                class="nav-link active"
                aria-current="page"
                href="../index.html"
                >Inicio</a
              >
              <!-- Enlace "Inicio" activo -->
            </li>
            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle active"
                href="#"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                Megamenu
                <!-- Enlace del megamenu activo -->
              </a>
              <!-- Menú desplegable -->
              <ul class="dropdown-menu bg-success text-light">
                <li class="px-2">MEGAPAQUETES</li>
                <li><hr class="dropdown-divider" /></li>
                <li>
                  <a
                    class="dropdown-item text-light"
                    href="../productos/verduras_productos.html"
                    >Verduras</a
                  >
                </li>
                <li>
                  <a
                    class="dropdown-item text-light"
                    href="../productos/frutas_productos.html"
                    >Frutas</a
                  >
                </li>
                <li>
                  <a
                    class="dropdown-item text-light"
                    href="../productos/tubérculos_hortalizas_productos.html"
                    >Tubérculos/Hortalizas</a
                  >
                </li>
              </ul>
            </li>
            <li class="nav-item">
              <a class="nav-link active" href="#">Ofertas</a>
              <!-- Enlace "Ofertas" activo -->
            </li>
            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle active"
                href="#"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                Sobre Nosotros
                <!-- Enlace "Sobre Nosotros" activo -->
              </a>
              <!-- Menú desplegable -->
              <ul class="dropdown-menu bg-success text-light">
                <li class="px-2">MEGAPAQUETES</li>
                <li><hr class="dropdown-divider" /></li>
                <li>
                  <a
                    class="dropdown-item text-light"
                    href="../sobre nosotros/sobre nosotros.html"
                    >Sobre Nosotros</a
                  >
                </li>
                <li>
                  <a
                    class="dropdown-item text-light"
                    href="../sobre nosotros/Contacto.html"
                    >Contacto</a
                  >
                </li>
                <li>
                  <a
                    class="dropdown-item text-light"
                    href="../sobre nosotros/Politicas.html"
                    >Politicas(Terminos y Condiciones)</a
                  >
                </li>
              </ul>
            </li>
            <li class="nav-item">
              <a class="nav-link disabled" aria-disabled="true">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="25"
                  height="25"
                  fill="currentColor"
                  class="bi bi-cart4"
                  viewBox="0 0 16 16"
                >
                  <path
                    d="M0 2.5A.5.5 0 0 1 .5 2H2a.5.5 0 0 1 .485.379L2.89 4H14.5a.5.5 0 0 1 .485.621l-1.5 6A.5.5 0 0 1 13 11H4a.5.5 0 0 1-.485-.379L1.61 3H.5a.5.5 0 0 1-.5-.5M3.14 5l.5 2H5V5zM6 5v2h2V5zm3 0v2h2V5zm3 0v2h1.36l.5-2zm1.11 3H12v2h.61zM11 8H9v2h2zM8 8H6v2h2zM5 8H3.89l.5 2H5zm0 5a1 1 0 1 0 0 2 1 1 0 0 0 0-2m-2 1a2 2 0 1 1 4 0 2 2 0 0 1-4 0m9-1a1 1 0 1 0 0 2 1 1 0 0 0 0-2m-2 1a2 2 0 1 1 4 0 2 2 0 0 1-4 0"
                  />
                </svg>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <!-- Sección principal del perfil del administrador -->
    <section class="contenedor__principal--usuario">
      <div class="contenedor__principal">
        <!-- Contenedor del título -->
        <div class="contenedor__titulo">
          <p><strong>Bienvenido, administrador</strong></p>
          <img src="../imagenes/Group 146.svg" alt="logo" />
        </div>
        <!-- Línea separadora -->
        <div class="contenedor__linea"></div>
        <!-- Contenedor del texto descriptivo -->
        <div class="contenedor__texto">
          <p>
            Aqui podras editar tu perfil, gestionar los pedidos, productos,
            usuarios y productos de temporada.
          </p>
        </div>
      </div>
    </section>

    <!-- Sección secundaria del perfil del administrador -->
    <section class="contenedor__secundario--usuario">
      <!-- Subtítulo de la sección de perfil -->
      <div class="contenedor__subtitulo">
        <p class="texto"><strong>Perfil</strong></p>
      </div>
      <!-- Línea separadora -->
      <div class="contenedor__linea"></div>
      <!-- Formulario de edición de perfil -->
      <div class="form__contenedor">
        <div class="formulario">
          <form action="#" method="POST" class="from__principal">
            <!-- Campo del nombre completo -->
            <div class="form__group">
              <label class="form__label" for="nombres">Nombres</label>
              <input
                class="form__input"
                type="text"
                id="nombres"
                name="nombres"
                required
              />
            </div>
            <!-- Campo de los apellidos -->
            <div class="form__group">
              <label class="form__label" for="apellidos">Apellidos</label>
              <input
                class="form__input"
                type="text"
                id="apellidos"
                name="apellidos"
                required
              />
            </div>
            <!-- Campo del correo -->
            <div class="form__group">
              <label class="form__label" for="correo">Correo</label>
              <input
                class="form__input"
                type="email"
                id="correo"
                name="correo"
                required
              />
            </div>
            <!-- Campo del teléfono -->
            <div class="form__group">
              <label class="form__label" for="telefono">Teléfono</label>
              <input
                class="form__input"
                type="tel"
                id="telefono"
                name="telefono"
                required
              />
            </div>
            <!-- Campo de la dirección -->
            <div class="form__group">
              <label class="form__label" for="direccion">Dirección</label>
              <input
                class="form__input"
                type="text"
                id="direccion"
                name="direccion"
                required
              />
            </div>
            <!-- Campo de la descripción -->
            <div class="form__group d-flex flex-column">
              <label class="form__label" for="descripcion">Descripción</label>
              <textarea
                class="textarea"
                id="descripcion"
                name="descripcion"
                rows="4"
                required
              ></textarea>
            </div>
            <!-- Campo de la fecha de registro -->
            <div class="form__group">
              <label class="form__label" for="fecha-registro"
                >Fecha de Registro</label
              >
              <input
                class="form__input"
                type="date"
                id="fecha-registro"
                name="fecha-registro"
                required
              />
            </div>
          </form>
        </div>
      </div>
    </section>

    <!-- Botón para actualizar perfil -->
    <div class="boton__actualizar">
      <a href="#" class="boton__actualizar-link">Actualizar perfil</a>
    </div>

    <!-- Pie de página -->
    <footer class="footer">
      <p class="footer__parrafo">@Megapaquetes</p>
    </footer>

    <script>
      //traer el usuario logueado
      const loggedInUser = JSON.parse(localStorage.getItem("loggedInUser"));

      //llenar formulario con los datos del usuario logueado
      if (loggedInUser) {
        document.getElementById("nombres").value = loggedInUser.nombres;
        document.getElementById("apellidos").value = loggedInUser.apellidos;
        document.getElementById("correo").value = loggedInUser.correo;
        document.getElementById("telefono").value = loggedInUser.telefono;
        document.getElementById("direccion").value = loggedInUser.direccion;
        document.getElementById("descripcion").value = loggedInUser.descripcion;
        document.getElementById("loggedInUserName").innerText =
          loggedInUser.nombres + " " + loggedInUser.apellidos;
      }

      //evento click en el boton actualizar
      document
        .querySelector("#actualizar")
        .addEventListener("click", (event) => {
          event.preventDefault();

          //actualiza los datos del usuario logueado
          const updatedUser = {
            nombres: document.getElementById("nombres").value,
            apellidos: document.getElementById("apellidos").value,
            correo: document.getElementById("correo").value,
            telefono: document.getElementById("telefono").value,
            direccion: document.getElementById("direccion").value,
            descripcion: document.getElementById("descripcion").value,
          };

          // guarda los datos
          localStorage.setItem("loggedInUser", JSON.stringify(updatedUser));

          // Obtener lista de usuarios
          let users = JSON.parse(localStorage.getItem("users")) || [];

          //buscar el usuario loguado en la lista de usuarios
          const index = users.findIndex(
            (user) => user.correo === updatedUser.correo
          );

          //si encuentra el usuario lo actualiza
          if (index !== -1) {
            users[index] = updatedUser;
            localStorage.setItem("users", JSON.stringify(users));
          }

          alert("Perfil actualizado con éxito");
          location.reload();
        });
    </script>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>
    <!-- Bootstrap Bundle JS desde CDN -->
  </body>
</html>
